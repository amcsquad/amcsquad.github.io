---
title: Python SBOM and Supply Chain Vulnerability Scanning
layout: post
post-image: "/assets/images/blog/sbom_supply_chain_security.jpg"
description: Creating a software bill of materials and detecting vulnerabilities in Python dependency packages
tags:
- howto
- devsecops
- sbom
- supply-chain-security
- python
- dependency-vulnerabilities
- blog
---

# The Topic

The software bill of materials (SBOM) and supply chain (package dependency) security risks have been discussed a lot in the wake of the notorious Log4j vunerability. My question was how to generate the SBOM and scan the dependency packages used by my Python code for vulnerabilities. Luckily I have found two tools that help me accomplish this:
- [cyclonedx-bom](https://github.com/CycloneDX/cyclonedx-python)
- [bomber](https://github.com/devops-kung-fu/bomber)

# The Actions

## Tool Installation

### cyclonedx-bom

I installed `cyclonedx-bom` from the Visual Studio Code Integrated Powershell terminal using `pip`:

```
pip install cyclonedx-bom
```

### bomber

As `bomber` at the time of writing does not support Windows, I had to run a Debian based Docker container that had a volume mounted to the project root directory of my Python code, download [the latest release](https://github.com/devops-kung-fu/hookz/releases) and install it from there using the following command:

```
dpkg -i bomber_<version_number>_linux_arm64.deb
```

## Tool Usage

### SBOM Generation

In the Visual Studio Code Integrated Powershell terminal, run the following command to create the JSON SBOM file called `pycyber.cyclonedxsbom.json` in the sub directory `sbom` of the project root directory.

```
cyclonedx-py --format json -o ./sbom/pycyber.cyclonedxsbom.json -e
```

### Dependency Package Vulnerability Scan

In the Debian based Docker container, `cd` into he `sbom` directory and run the following command to create a HTML dependency package vulnerability report there using the `pycyber.cyclonedxsbom.json` as the input.

```
root# cd sbom
root# bomber scan pycyber.cyclonedxsbom.json --output=html
```

# The Result

The report name follows this naming convention: `yyyymmdd-hh-mm-ss-bomber-results.html` and look like as follows.

![Bomber SBOM Vulnerability Report](/assets/images/blog/bomber_report.png "Bomber Software Supply Chain Vulnerability Report")

# Follow-Up Actions

From the report, I can identify the vulnerable dependency packages and their version. I then use the [pipdeptree](https://github.com/tox-dev/pipdeptree) tool to identify the packages that requires them using the following command.

```
pipdeptree -r -p MarkupSafe,numpy
```

I then update version numbers of the identified packages in the `requirements.txt` to the latest or the ones that do not use the vulnerable versions of the dependency packages. Finally, I regenerate SBOM and vulnerability report again to make sure that no vulnerabilities are reported.
